#!/bin/bash

help() {
  echo "Usage:"
  echo "  zmicro lapce <mount|umount> <webdav_url> <webdav_path>"
  echo ""
  echo "Example:"
  echo "  zmicro lapce"
}

core() {
  local action=$1
  local args=${@:2}

  case $action in
  mount)
    if [ -z "$UID" ]; then
      export UID=$(id -u)
    fi

    if [ -z "$GID" ]; then
      export GID=$(id -g)
    fi

    sudo mount.lapce -o uid=$UID,gid=$GID $args
    ;;
  umount)
    sudo umount.lapce $args
    ;;
  -h | --help)
    help
    exit 0
    ;;
  *)
    log::error "unknown action: $action"
    help
    exit 1
    ;;
  esac
}

run() {
  core "$@"
}

run "$@"
